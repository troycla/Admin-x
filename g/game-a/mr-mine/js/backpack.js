var backpack=[],backpackSize=100,isBackpackDirty=!1,isCraftNotificationOn=!1;function initBackpack(a){for(var c=backpack.length/2,k=0;k<a-c;++k)backpack.push(-1,0)}function getBackpackSize(){return backpack.length/2}function getItemInBackpackById(a){for(var c=[],k=0;k<2*backpack.length;k+=2)backpack[k]==a&&backpack[k+1]>0&&c.push({id:a,quantity:backpack[k+1],slot:k/2});return c}function getItemInBackpackSlot(a){return a>=backpack.length/2||a<0||isBackpackSlotEmpty(a)?null:{id:backpack[2*a],quantity:backpack[2*a+1],slot:a}}function getAllItemsInBackpack(){for(var a,c=[],k=0;k<backpack.length/2;++k)(a=getItemInBackpackSlot(k))&&c.push(a);return c}function getQuantityOfItemInBackpack(a,c=-1){for(var k=0,t=0;t<2*backpack.length&&(-1==c||k<c);t+=2)backpack[t]==a&&(k+=backpack[t+1]);return k}function addItemToBackpack(a,c,k=-1){var t,e,n;if(getItemById(a)){if(k>backpack.length)throw"Invalid backpack slot";if(k>-1&&(t=getItemInBackpackSlot(k))&&t.id==a)backpack[2*k+1]+=c;else if(k>-1&&null===t)backpack[2*k]=a,backpack[2*k+1]=c;else if((e=getItemInBackpackById(a))&&e.length>0)backpack[2*e[0].slot+1]+=c,k=e[0].slot;else{if(null===(n=getFirstEmptySlotInBackpack()))return!1;backpack[2*n]=a,backpack[2*n+1]=c,k=n}return isBackpackDirty=!0,k}}function removeItemFromBackpackSlot(a,c=0){var k=backpack[2*a+1];return isBackpackDirty=!0,0==c||k<=c?(backpack[2*a]=-1,backpack[2*a+1]=0,k):(backpack[2*a+1]-=c,c)}function removeItemFromBackpackById(a,c=0){for(var k=getItemInBackpackById(a),t=0,e=0;e<k.length&&(0==c||t<c);)t+=removeItemFromBackpackSlot(k[e].slot,c-t),++e;return t}function moveItemInBackpack(a,c){if(!(c<0||c>=getBackpackSize())){var k=getItemInBackpackSlot(a),t=getItemInBackpackSlot(c);k&&(removeItemFromBackpackSlot(a),t&&t.id!=k.id&&(removeItemFromBackpackSlot(c),addItemToBackpack(t.id,t.quantity,a)),addItemToBackpack(k.id,k.quantity,c),isBackpackDirty=!0)}}function isBackpackSlotEmpty(a){return backpack[2*a]<0||backpack[2*a+1]<=0}function getFirstEmptySlotInBackpack(){for(var a=0;a<2*backpack.length;a+=2)if(backpack[a]<0||backpack[a+1]<=0)return a/2;return null}function getItemById(a){if(backpackItems[a]&&backpackItems[a].id==a)return backpackItems[a];for(var c=0;c<backpackItems.length;++c)if(backpackItems[c].id==a)return backpackItems[c];throw"Invalid item ID"}function generateTestBackpack(a){backpack=[],initBackpack(a);for(var c=0;c<a;++c){addItemToBackpack(backpackItems[rand(0,backpackItems.length-1)].id,rand(1,99),c)}}backpack.length<backpackSize&&initBackpack(backpackSize);