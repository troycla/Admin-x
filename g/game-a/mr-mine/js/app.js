buildTarget=WEB_BUILD;var CHEATS_ENABLED=!1,version=143,buildLetter="C"+(isDev()?"."+revisionNumber:""),latestTestNumber=9,UID=platform.getUserId(),money=new BigNumber(0),totalMoneyEarnedSession=new BigNumber(0),tickets=0,oldversion=version,earliestVersion=version,firstTimePlayed=Math.floor((new Date).getTime()/1e3),specialUpgrades=[0,0,0,0,0,0,0,0,0,0],quality=1,hasFoundGolem=0,hasFoundGidget=0,hasFoundUfo=0,playtime=0,servertime=Math.round((new Date).getTime()/1e3),savetime=Math.round((new Date).getTime()/1e3),numGameLaunches=1,centsSpent=0,lastLocationIsEarth=[!0,!0,!0,!0],isDevUser=isDev(),activePlayTimeMinutes=0,activePlayTimeMinutesInSession=0,timelapseMinutesInSession=0,totalPlayMinutes=0,hasImported=null!==localStorage.getItem("importedList"),hasTakenSurvey=!1;function hasTakenSurveyCheck(){return hasTakenSurvey||1==localStorage.hasTakenSurvey||"true"==localStorage.hasTakenSurvey}var paypalhtml,paidForMinerName,testNumber=0,sessionId=Math.round((new Date).getTime()/1e3)+"_"+Math.round(Number.MAX_SAFE_INTEGER*Math.random()),lastPlatform=platformName(),previousPlatform=platformName(),checks=[1,1,0,0,0,0,0],pendingDeleteSlotIndex=0,drillPurchasePage=0,numFramesRendered=0,framesRendered2=0,currentlyViewedDepth=0,partialDepthOffset=0,afk=15,lgame=0,isWindowInFocus=1,isTimelapseOn=!1,totalTimeLapsedMinutes=0,editmode=0,relicEditMode=0,customMinerDatabaseIndex=-1,musicFadeInVolume=0,hasOpenedPurchaseWindow=!1,lastFlashQuestionPromptClickTime=0;window.TrackJS&&(TrackJS.addMetadata("userId",UID),TrackJS.addMetadata("version",version+"_"+buildLetter),TrackJS.addMetadata("isDev",isDevUser),TrackJS.addMetadata("platform",platformName()));var purchasePacks=[{},{ag_sku:"m-10_tickets:1",priceCents:100,tickets:10,description:_("Pack of {0} tickets","10")},{ag_sku:"m-55_tickets:1",priceCents:500,tickets:55,description:_("Pack of {0} tickets","55")},{ag_sku:"m-120_tickets:1",priceCents:1e3,tickets:120,description:_("Pack of {0} tickets","120")},{ag_sku:"m-250_tickets:1",priceCents:2e3,tickets:250,description:_("Pack of {0} tickets","250")},{ag_sku:"m-650_tickets:1",priceCents:5e3,tickets:650,description:_("Pack of {0} tickets","650")},{ag_sku:"m-1400_tickets:1",priceCents:1e4,tickets:1400,description:_("Pack of {0} tickets","1400")}],updatePerPoint1Second=new EventHook,updatePerSecond=new EventHook,updatePer30Seconds=new EventHook,updatePerMinute=new EventHook,updatePer5Minutes=new EventHook;function timelapse(e,t=!0){t&&!isOfflineProgressActive&&(e*=STAT.timelapseDurationMultiplier());var a=isWindowInFocus;isWindowInFocus=0,isTimelapseOn=!0;for(var i=Math.floor(60*e),n=i;i>0;i--)isSimulating?i==n&&(dig(n),superMinerManager.update(n),chestCompressor.update(n),GemForger.update(n),upgradelogic(n),progressScientistExcavations(n)):(dig(1),superMinerManager.update(1),chestCompressor.update(1),GemForger.update(1),upgradelogic(1),progressScientistExcavations(1)),buffs.update(),reactor.update(),i%60==30&&runOptimizedMiningForOneMinute();handleTradeTimelapse(e),isTimelapseOn=!1,isWindowInFocus=a,isOfflineProgressActive||isSimulating&&!t||(totalTimeLapsedMinutes+=e,timelapseMinutesInSession+=e)}var isGameLoaded=!1;platform.frameRefreshForSteamOverlay&&platform.frameRefreshForSteamOverlay(),window.onload=function(){if(console.log("loaded"),checkUserCanSave(),platform.setWindowSize&&platform.setWindowSize(),setVolume(),setupButtons(),updateBackup(),downloadBackup(),console.log("Version: "+(version/100-1).toFixed(2)+" build "+buildLetter),isGameLoaded=!0,CHEATS_ENABLED&&"true"==localStorage.debug_loadTinyAssets&&(localStorage.debug_loadTinyAssets=!1),isSteam()?document.getElementById("steamCloudBackup").style.visibility="visible":isWeb()&&(document.getElementById("steamCloudBackup").style.visibility="visible",document.getElementById("steamCloudBackup").onclick=null,document.getElementById("steamCloudBackup").onmouseover=function(){showTooltipForDiv(_("Cloud backups are only available on the Steam version"),"","steamCloudBackup")}),generateReactorComponents(),""==languageOverride&&0==RSc){var e="undefined",t=platform.getSystemLanguage(),a=document.querySelector("[data-language='"+t+"']");a&&(e=a.innerHTML);var i=_("Starting with language set to {0}",e);"English"!=e&&(i+=" \n (Starting with language set to "+(t=t[0].toUpperCase()+t.slice(1))+")"),isMobile()&&showConfirmationPrompt(i,_("Okay"),(function(){}),_("Change Language"),showLanguageSelection)}setTimeout(handleWindowResizeEvent,1e3),setTimeout(setGameToReady,1050)},window.onbeforeunload=function(){trackeEvent_exitedGame()};var isGameReady=!1;function setGameToReady(){isGameReady=!0,hideDiv("loadingOverlay"),isMobile()&&!loadGame(0)&&("undefined"!=typeof cordova?platform.loadLocalStorageFromFile((function(){createNewGame("save0")})):createNewGame("save0")),"undefined"!=typeof cordova&&navigator.splashscreen&&navigator.splashscreen.hide(),parseInt(localStorage.numSims)>0&&(console.log("sims remaining:"+localStorage.numSims),setTimeout((()=>{runDepthSim(parseInt(localStorage.simDepth),parseInt(localStorage.numSims))}),2e3))}function getBuildTarget(){return"undefined"!=typeof buildTarget?buildTarget:STEAM_BUILD}function isDesktop(){return isSteam()||isWeb()}function isWeb(){return getBuildTarget()==WEB_BUILD}function isSteam(){return getBuildTarget()==STEAM_BUILD}function isMobile(){return getBuildTarget()==MOBILE_BUILD}function platformName(){return isWeb()?"web":isSteam()?"steam":isMobile()?platform.isIOs()?"ios":"android":"unknown"}setInterval((function(){if("undefined"!=typeof chosen&&isSaveFileLoaded()&&(!isMobile()||void 0!==platform.pauseTime&&platform.pauseTime<0)&&(playtime+=1,dig(1),getUsedMineralCapacity(),upgradelogic(1),superMinerManager.update(1),chestCompressor.update(1),buffs.update(),updateUserExperience(),checkForNewTrade(),checkForCompletedExcavations(),GemForger.update(1),updateQuotes(1),reactor.update(),updatePerSecond.fire(),secondsSinceOrangeFishSpawn++,questManager.update(),isMobile()&&notificationManager.update()),servertime++,savetime++,!isWindowInFocus&&"undefined"!=typeof chosen&&isSaveFileLoaded()&&(document.title=_("Capacity")+": "+Math.floor(100*capacity/maxHoldingCapacity())+"%"),musicFadeInVolume<.08&&"undefined"!=typeof chosen&&isSaveFileLoaded()&&0==mute&&(musicFadeInVolume+=.01,platform.setVolume?platform.setVolume(musicFadeInVolume):platform.music&&(platform.music.volume=Math.min(1,platform.music.volume+musicFadeInVolume))),"undefined"!=typeof chosen&&isSaveFileLoaded()&&!hasTakenSurveyCheck()&&("true"==localStorage.isSurveyPending||1==localStorage.isSurveyPending)&&performance.now()>4e3){hasTakenSurvey=!0,localStorage.hasTakenSurvey=!0,localStorage.isSurveyPending=!1;var e=5*surveyRewardMultiplier();if(tickets+=e,void 0!==localStorage.q1){var t=25*(parseInt(localStorage.q1)-1);trackEvent_logSentiment(t)}if(void 0!==localStorage.q9){var a=25*(parseInt(localStorage.q9)-1);trackEvent_logConfusionLevel(a)}alert(_("You gained {0} tickets",e)),newNews(_("You gained {0} tickets",e),!0),savegame()}if("undefined"!=typeof chosen&&isSaveFileLoaded()&&hasTakenSurveyCheck()&&("true"==localStorage.isServerSurveyPending||1==localStorage.isServerSurveyPending)&&performance.now()>4e3){localStorage.isServerSurveyPending=!1;var i=parseInt(localStorage.serverSurveyRewardAmount);isNaN(i)||(tickets+=i,alert(_("You gained {0} tickets",i)),newNews(_("You gained {0} tickets",i),!0),savegame()),localStorage.serverSurveyRewardAmount=0}}),1e3),setInterval((function(){isSaveFileLoaded()&&(!isMobile()||void 0!==platform.pauseTime&&platform.pauseTime<0)&&(savegame(),afk--,chestService.spawnRandomChests(),spawnWorldClickables(),battlerand(),updatePer30Seconds.fire(),isSteam()&&updateDiscordRichPresence())}),3e4);var mouseMoved=!1;function requiresUpdate(e,t){return t>=e||currentTime()%e<t}setInterval((function(){isSaveFileLoaded()&&(!isMobile()||void 0!==platform.pauseTime&&platform.pauseTime<0)&&(pinnedBlueprintsManager.update(),logValuationStats(),updatePerMinute.fire(),mouseMoved&&(activePlayTimeMinutesInSession+=1,activePlayTimeMinutes+=1,mouseMoved=!1),totalPlayMinutes+=1)}),6e4),setInterval((function(){isSaveFileLoaded()&&(!isMobile()||void 0!==platform.pauseTime&&platform.pauseTime<0)&&(backupSavesToCloud(),updatePer5Minutes.fire()),isSaveFileLoaded()&&!isMobile()&&loadAmountOfFlashQuestions(),"undefined"!=typeof offerManager&&chosen>=0&&offerManager.update()}),3e5);var previousTime=0,expectedNextRepaintTime=0,animationInterval=1e3/IDLE_FRAMERATE,miningInterval=100;function expectedTimeUntilNextRepaintMsec(){return currentTime()-expectedNextRepaintTime}setInterval((function(){var e=currentTime()-previousTime;previousTime=currentTime(),"undefined"!=typeof activeLayers&&updateUi(animationInterval),"undefined"!=typeof activeLayers&&void 0!==activeLayers.Stage&&(activeLayers.Stage.isRendered&&activeLayers.Stage.hitboxes.length>0&&activeLayers.Stage.render(),writeToMouseDeltaBuffer(0,0)),requiresUpdate(34,e)&&"undefined"!=typeof activeLayers&&void 0!==activeLayers.Particles&&activeLayers.Particles.isRendered&&activeLayers.Particles.render(),requiresUpdate(animationInterval,e)&&(!isGameLoaded||!isSimulating&&isTimelapseOn||isOfflineProgressActive?isGameLoaded||(document.getElementById("LoadingText").innerHTML=_("Loading..."),document.getElementById("LoadingPercent").innerHTML=Math.floor(100*getPageLoadPercent())+"%",document.getElementById("LoadingBar").style.width=Math.floor(100*getPageLoadPercent())+"%"):(numFramesRendered++,animate(),expectedNextRepaintTime=currentTime()+animationInterval,updateUpdatingTooltip()))}),17),runDtMiningAndCaveLogic();var lastUpdateTime=currentTime(),residualTime=0,numMinings=0;function runDtMiningAndCaveLogic(){if(isGameLoaded&&(!isSimulating||!isTimelapseOn)&&!isOfflineProgressActive&&(!isMobile()||void 0!==platform.pauseTime&&platform.pauseTime<0)){var e=currentTime()-lastUpdateTime;lastUpdateTime=currentTime();for(var t=e+residualTime;t>=.5*miningInterval;)mine(),caveUpdate(CAVE_UPDATE_DELTA_TIME_SECONDS),t-=miningInterval,numMinings++;residualTime=t}setTimeout(runDtMiningAndCaveLogic,miningInterval-residualTime)}var numFlashQuestions=0,hasVisitedFlashQuestionSurveyDuringCurrentSession=!1,millisecondsBetweenQuestionQueryTime=144e5,lastFlashQuestionQueryTime=0;function loadAmountOfFlashQuestions(){if(currentTime()-lastFlashQuestionQueryTime>=millisecondsBetweenQuestionQueryTime&&!hasVisitedFlashQuestionSurveyDuringCurrentSession&&1==isWindowInFocus&&0==numFlashQuestions&&lastFlashQuestionPromptClickTime<currentTime()-864e5){lastFlashQuestionQueryTime=currentTime();var e="https://playsaurusstats.com/SurveyFlashQuestionManager.php?cmd=getSurveyHTMLForUnansweredLiveQuestions&gameName=MrMine&gameUid="+UID,t=new XMLHttpRequest;t.open("GET",e,!0),t.setRequestHeader("Content-type","application/x-www-form-urlencoded"),t.onreadystatechange=function(){4==t.readyState&&void 0!==t.responseText&&(numFlashQuestions=parseInt(t.responseText.split("appendQuestion").length-1))},t.send()}}function isFlashQuestionSurveyPromptVisible(){return hasTakenSurveyCheck()&&numFlashQuestions>0&&!hasVisitedFlashQuestionSurveyDuringCurrentSession&&lastFlashQuestionPromptClickTime<currentTime()-864e5&&"true"!=localStorage.isServerSurveyPending&&1!=localStorage.isServerSurveyPending}function openFlashQuestionPrompt(){if(isFlashQuestionSurveyPromptVisible()){var e=document.createElement("div");e.id="surveyDiv",e.style.cssText="position:absolute;left:10%;top:10%;width:80%;height:80%;z-index:100;background:#000;border: 1px solid black;",e.innerHTML='<iframe src="./Shared/ServerSurvey.html?UID='+UID+"&version="+version+"&depth="+depth+"&reward="+numFlashQuestions+'" frameBorder="0" style="width: 100%; height: 100%; boder:0;"></iframe>';var t=document.createElement("div");t.id="surveyExitButton",t.style.position="absolute",t.style.top="0px",t.style.right="0px",t.style.width="25px",t.style.height="25px",t.style.zIndex=4,t.style.background="url('Shared/Assets/UI/closei.png') no-repeat center",t.style.backgroundSize="contain",t.style.color="white",t.style.display="block",t.style.padding="0px",t.style.cursor="pointer",t.onclick=function(){document.getElementById("surveyDiv").visibility="hidden",document.body.removeChild(document.getElementById("surveyDiv"))},e.appendChild(t),document.body.appendChild(e),lastFlashQuestionPromptClickTime=currentTime(),hasVisitedFlashQuestionSurveyDuringCurrentSession=!0}}var consoleLog=[];function patchConsole(){if("undefined"!=typeof console){function e(e,t){window.console[e]=function(...e){return consoleLog.push(e.join(", ")),consoleLog.length>100&&consoleLog.shift(),t(...e)}}e("log",console.log),e("info",console.info),e("warn",console.warn),e("error",console.error),e("debug",console.debug)}}patchConsole();var throttle=0;function addMoney(e){Number.isNaN(e)||(money=money.add(e),totalMoneyEarnedSession=totalMoneyEarnedSession.add(e))}function subtractMoney(e){Number.isNaN(e)||(money=money.subtract(e))}function addDepth(e){isNaN(e)||(depth+=e,activeLayers.WorldLayer.updateLevels&&activeLayers.WorldLayer.updateLevels(),newNews(_("You dug to {0}km!",depth),!0),trackEvent_DepthIncrease(depth),handleNewDepth())}function handleNewDepth(){for(var e=0;e<tradeConfig.tradingPosts.length;++e)depth==tradeConfig.tradingPosts[e].depth&&newNews(_("You have discovered a broken trading post at {0}km!",tradeConfig.tradingPosts[e].depth));12==depth&&workersHiredAtDepth(12)>0&&unlockScientistsEarly&&chestService.spawnChest(12,Chest.natural,ChestType.basic,1),50==depth&&newNews(_("Check out 50km to purchase from the golem"),!0),BattleManager.isStalledDueToBoss()&&newNews(_("Your drill is stalled, defeat the boss to continue digging deeper!"),!0);var t=STAT.getPikeHours();if(t>0&&highestOreUnlocked>0){var a=60*estimateTotalMineralsMinedPerSecond()[highestOreUnlocked],i=Math.floor(a*t*60);isNaN(i)||(worldResources[highestOreUnlocked].numOwned+=i,newNews(_("Your pike relics gained you {0}x {1}",beautifynum(i),worldResources[highestOreUnlocked].name)))}if(depth>=303&&0==story&&!isSimulating){for(e=0;e<battleInventory.length;e++)if(battleInventory[e].length>0){var n=battleInventory[e][0];try{makeBlueprintAvailable(2,n),learnBlueprint(2,n)}catch(t){console.warn(t),battleInventory[e]=[]}}startUndergroundCityStory()}learnReachedBlueprints()}function getPurchasePackIndexBySku(e){for(var t in purchasePacks)if(purchasePacks[t].ag_sku==e)return t}function surveyRewardMultiplier(){return 0==centsSpent?depth<500?1:2:centsSpent<=2e3?2:centsSpent<=1e4?5:10}