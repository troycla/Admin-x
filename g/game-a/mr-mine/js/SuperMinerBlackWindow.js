class SuperMinerBlackWindow extends PopupWindow{layerName="SuperMinerBlackWindow";domElementId="SUPBD";context=SBD;isRendered=!0;isPopup=!0;allowBubbling=!1;zIndex=4;animationDuration=1e3;animationTimer;superMinerFrameWidth=.25;buttonWidth=.15;buttonAreaWidth=.5;constructor(t,i){super(t),this.setBoundingBox(),this.superMiner=i,this.animationTimer=this.animationDuration,this.initMinerPortrait(),this.initButtons()}initMinerPortrait(){var t=this.superMiner.rarity.popupFrame,i=this.boundingBox.width*this.superMinerFrameWidth,e=t.height*(i/t.width),n=this.addHitbox(new Hitbox({x:(this.boundingBox.width-i)/2,y:.4*this.boundingBox.height-e/2,width:i,height:e},{},""));n.render=function(){var t=this.getRelativeCoordinates(0,0,this.parent);this.parent.context.drawImage(this.parent.superMiner.rarity.popupFrame,t.x,t.y,this.boundingBox.width,this.boundingBox.height),drawImageFitInBox(this.parent.context,this.parent.superMiner.portrait,t.x+.205*this.boundingBox.width,t.y+.031*this.boundingBox.height,.593*this.boundingBox.width,.621*this.boundingBox.height),this.parent.superMiner.buttonIcon&&drawImageFitInBox(this.parent.context,this.parent.superMiner.buttonIcon,t.x+.398*this.boundingBox.width,t.y+.776*this.boundingBox.height,.208*this.boundingBox.width,.217*this.boundingBox.height),this.renderChildren()},n.addHitbox(new Hitbox({x:.25*i,y:.67*e,width:.5*i,height:.05*e},{})).render=function(){var t=this.getRelativeCoordinates(0,0,this.parent.parent),i=this.parent.parent.context,e=this.parent.parent.superMiner.rarity.name;i.save(),i.font=this.boundingBox.height+"px KanitB",i.strokeStyle="#FFFFFF",i.lineWidth=2,strokeTextShrinkToFit(i,e,t.x,t.y,this.boundingBox.width,"center"),i.fillStyle="#A25D03",fillTextShrinkToFit(i,e,t.x,t.y,this.boundingBox.width,"center"),i.restore()},this.addHitbox(new Hitbox({x:.1*this.boundingBox.width,y:n.boundingBox.y-.055*this.boundingBox.height,width:.8*this.boundingBox.width,height:.05*this.boundingBox.height},{},"")).render=function(){var t=this.getRelativeCoordinates(0,0,this.parent);this.parent.context.save(),this.parent.context.textBaseline="top",this.parent.context.font=this.boundingBox.height+"px KanitB",this.parent.context.fillStyle="#FFFFFF",fillTextShrinkToFit(this.parent.context,this.parent.superMiner.name,t.x,t.y,this.boundingBox.width,"center"),this.parent.context.restore()},this.addHitbox(new Hitbox({x:n.boundingBox.x,y:n.boundingBox.y+e+.01*this.boundingBox.height,width:i,height:.13*this.boundingBox.height},{},"")).render=function(){var t=this.getRelativeCoordinates(0,0,this.parent);this.parent.context.save(),this.parent.context.textBaseline="top",this.parent.context.font=.25*this.boundingBox.height+"px Verdana",this.parent.context.fillStyle="#FFFFFF",this.parent.superMiner.renderDescription(this.parent.context,t.x,t.y,this.boundingBox.width,this.boundingBox.height,"center"),this.parent.context.restore()}}initButtons(){var t=this.boundingBox.width*this.buttonWidth,i=startb.height*(t/startb.width),e=this.boundingBox.width*this.buttonAreaWidth/2;this.equipButton=this.addHitbox(new Hitbox({x:e+(this.boundingBox.width*this.buttonAreaWidth-2*t)/3,y:this.boundingBox.height-2*i,width:t,height:i},{onmousedown:()=>{superMinerManager.isFull()?showConfirmationPrompt(_("You have no slots available to equip {0}. Do you want to make room or scrap {0} for {1} Super Miner Souls?",this.superMiner.name,this.superMiner.scrapAmount()),_("Make room"),(()=>{this.madeAChoice=!0,openUiWithoutClosing(SuperMinerSelectorWindow,null,this.superMiner),openUiWithoutClosing(SuperMinersWindow,null,0,!0),closeUi(this)}),_("Scrap"),(()=>{this.madeAChoice=!0,superMinerManager.removePendingSuperMiner()&&this.superMiner.scrap(),closeUi(this)})):(this.madeAChoice=!0,superMinerManager.addSuperMiner(this.superMiner),superMinerManager.removePendingSuperMiner(),closeUi(this))}},"pointer","equipButton")),this.equipButton.render=function(){var t=this.getRelativeCoordinates(0,0,this.parent),i=this.parent.context;i.save(),i.drawImage(startb,t.x,t.y,this.boundingBox.width,this.boundingBox.height),i.lineWidth=5,i.strokeStyle="#000000",i.fillStyle="#FFFFFF",i.textBaseline="top",i.font=.7*this.boundingBox.height+"px KanitB",strokeTextWrapWithHeightLimit(i,_("Equip"),t.x+.1*this.boundingBox.width,t.y+.15*this.boundingBox.height,.8*this.boundingBox.width,.7*this.boundingBox.height,"center"),fillTextWrapWithHeightLimit(i,_("Equip"),t.x+.1*this.boundingBox.width,t.y+.15*this.boundingBox.height,.8*this.boundingBox.width,.7*this.boundingBox.height,"center"),i.restore()},this.scrapButton=this.addHitbox(new Hitbox({x:e+(2*this.boundingBox.width*this.buttonAreaWidth-t)/3,y:this.boundingBox.height-2*i,width:t,height:i},{onmousedown:()=>{showConfirmationPrompt(_("Are you sure you want to scrap {0} for {1} Super Miner Souls?",this.superMiner.name,this.superMiner.scrapAmount()),_("Yes"),(()=>{this.madeAChoice=!0,superMinerManager.removePendingSuperMiner()&&this.superMiner.scrap(),closeUi(this)}),_("No"))}},"pointer","scrapButton")),this.scrapButton.render=function(){var t=this.getRelativeCoordinates(0,0,this.parent),i=this.parent.context;i.drawImage(stopb,t.x,t.y,this.boundingBox.width,this.boundingBox.height),i.lineWidth=5,i.strokeStyle="#000000",i.fillStyle="#FFFFFF",i.textBaseline="top",i.font=.7*this.boundingBox.height+"px KanitB",strokeTextWrapWithHeightLimit(i,_("Scrap"),t.x+.1*this.boundingBox.width,t.y+.15*this.boundingBox.height,.8*this.boundingBox.width,.7*this.boundingBox.height,"center"),fillTextWrapWithHeightLimit(i,_("Scrap"),t.x+.1*this.boundingBox.width,t.y+.15*this.boundingBox.height,.8*this.boundingBox.width,.7*this.boundingBox.height,"center")}}close(){if(this.madeAChoice)return super.close();showConfirmationPrompt(_("Are you sure you want to scrap {0} for {1} Super Miner Souls?",this.superMiner.name,this.superMiner.scrapAmount()),_("Yes"),(()=>(this.madeAChoice=!0,superMinerManager.removePendingSuperMiner()&&this.superMiner.scrap(),super.close())),_("No"))}render(){this.context.clearRect(0,0,this.boundingBox.width,this.boundingBox.height);let t=Math.min(1,(this.animationDuration-this.animationTimer)/this.animationDuration);var i=lerp(0,Math.max(this.boundingBox.width,this.boundingBox.height),t);this.context.globalAlpha=3*t*1,this.context.globalCompositeOperation="source-over",drawCircle(this.context,this.boundingBox.width/2,this.boundingBox.height/2,i,"#000000","#000000",0),t<1?(this.context.globalCompositeOperation="source-atop",this.animationTimer-=renderDeltaTime):this.context.globalCompositeOperation="source-over",this.context.globalAlpha=1,this.context.save();let e=2e3;this.context.globalAlpha=1-oscillate(performance.now(),e);var n=performance.now()%2e4/2e4;drawImageLoop(this.context,dots1,0,0,this.boundingBox.width,this.boundingBox.height,n),this.context.globalAlpha=.7,n=performance.now()%16e3/16e3,drawImageLoop(this.context,dots2,0,0,this.boundingBox.width,this.boundingBox.height,n),this.context.restore(),this.renderChildren()}}