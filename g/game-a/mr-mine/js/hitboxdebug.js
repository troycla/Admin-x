const hitboxLabelMode={pixels:0,percent:1,id:2};var hitboxDebugSettings={labelMode:hitboxLabelMode.id,showLines:!0,showLabels:!0,xLabelLocation:"top",onlyShowTopLayer:!0,lineColor:"#FFFFFF",lineOutlineColor:"#000000",lineWidth:2,lineOutlineWidth:4,lineDash:[4,8],lineAlpha:.5,boxOutlineWidth:2,boxOutlineAlpha:1,boxColors:["#ff0000","#ffaa00","#ffff00","#00ff00","#0000ff","#ff00ff"]};class HitboxDebug extends UiLayer{layerName="HitboxDebug";zIndex=4;isRendered=!0;isPopup=!1;allowBubbling=!0;context=null;debugCanvas;currenthitboxLabelType;constructor(e,t=-1,o=null){super(e),t>=0&&(hitboxDebugSettings.labelMode=t),null!==o&&(hitboxDebugSettings.onlyShowTopLayer=o)}setBoundingBox(){this.boundingBox=this.context.canvas.getBoundingClientRect(),this.boundingBox.x/=uiScaleX,this.boundingBox.y/=uiScaleY,this.boundingBox.width/=uiScaleX,this.boundingBox.height/=uiScaleY}open(){this.debugCanvas=document.createElement("canvas"),this.debugCanvas.style.position="absolute",this.debugCanvas.style.left=0,this.debugCanvas.style.top=0,this.debugCanvas.style.zIndex=999,document.body.appendChild(this.debugCanvas),this.debugCanvas.width=mainw,this.debugCanvas.height=mainh,this.context=this.debugCanvas.getContext("2d")}close(){return document.body.removeChild(this.debugCanvas),!0}onmousedown(e){this.isRendered&&e.shiftKey&&logMouseCoordinates()}render(){var e=this.context;e.save(),e.clearRect(0,0,this.boundingBox.width,this.boundingBox.height),e.globalAlpha=hitboxDebugSettings.boxOutlineAlpha,e.lineWidth=hitboxDebugSettings.boxOutlineWidth;var t=Object.values(activeLayers);if(hitboxDebugSettings.onlyShowTopLayer&&t.length>5)var o=(t=t[t.length-1].layerName!=this.layerName?[t[t.length-1]]:[t[t.length-2]])[0].layerName;for(var i=0;i<t.length;++i){var n=t[i].layerName?uiScaleX:1,a=t[i].layerName?uiScaleY:1;e.beginPath(),e.strokeStyle=hitboxDebugSettings.boxColors[0],e.strokeRect(t[i].boundingBox.x*n,t[i].boundingBox.y*a,t[i].boundingBox.width*n,t[i].boundingBox.height*a),e.stroke(),this.drawHitboxDebugForLayer(e,t[i])}hitboxDebugSettings.showLines&&(e.lineCap="round",e.setLineDash(hitboxDebugSettings.lineDash),e.globalAlpha=hitboxDebugSettings.lineAlpha,hitboxDebugSettings.lineOutlineWidth>0&&(e.beginPath(),e.strokeStyle=hitboxDebugSettings.lineOutlineColor,e.lineWidth=hitboxDebugSettings.lineOutlineWidth,e.moveTo(0,Math.round(mouseY)),e.lineTo(mainw,Math.round(mouseY)),e.moveTo(Math.round(mouseX),0),e.lineTo(Math.round(mouseX),mainh),e.stroke()),hitboxDebugSettings.lineWidth>0&&(e.beginPath(),e.strokeStyle=hitboxDebugSettings.lineColor,e.lineWidth=hitboxDebugSettings.lineWidth,e.moveTo(0,Math.round(mouseY)),e.lineTo(mainw,Math.round(mouseY)),e.moveTo(Math.round(mouseX),0),e.lineTo(Math.round(mouseX),mainh),e.stroke()),e.setLineDash([]),e.globalAlpha=1);var l=candidateHitboxes.concat(Array.from(Object.values(activeLayers)));if(hitboxDebugSettings.showLabels)for(var i in l){var s=l[i];if(!("WorldLayer"==s.layerName||hitboxDebugSettings.onlyShowTopLayer&&1==t.length&&s.getRootLayer().layerName!=o)){var b=s.getGlobalCoordinates(0,0),u={top:"",left:""};if(hitboxDebugSettings.labelMode==hitboxLabelMode.pixels){var h=s.getLocalCoordinates(mouseX,mouseY);u.top=Math.round(h.x),u.left=Math.round(h.y)}else if(hitboxDebugSettings.labelMode==hitboxLabelMode.percent){h=s.getLocalCoordinates(mouseX,mouseY);u.top=(100*h.x/s.boundingBox.width).toFixed(1)+"%",u.left=(100*h.y/s.boundingBox.height).toFixed(1)+"%"}else if(hitboxDebugSettings.labelMode==hitboxLabelMode.id){if(s.id)var g=s.id;else g="";u.top=g}var d,x=Math.max(12,Math.min(24,Math.floor(s.boundingBox.height*uiScaleY/3)));e.font="bold "+x+"px Courier New",e.strokeStyle="#000000",e.lineWidth=3,e.textBaseline="top","top"==hitboxDebugSettings.xLabelLocation?d=b.y*uiScaleY:"bottom"==hitboxDebugSettings.xLabelLocation&&(d=b.y*uiScaleY+s.boundingBox.height*uiScaleY-x);strokeTextShrinkToFit(e,u.left,b.x*uiScaleX,b.y*uiScaleY+s.boundingBox.height*uiScaleY/2,s.boundingBox.width*uiScaleX/3,"left"),strokeTextShrinkToFit(e,u.top,b.x*uiScaleX+s.boundingBox.width*uiScaleX/3,d,s.boundingBox.width*uiScaleX/3,"center");s.layerName,e.fillStyle="#FFFFFF",fillTextShrinkToFit(e,u.left,b.x*uiScaleX,b.y*uiScaleY+s.boundingBox.height*uiScaleY/2,s.boundingBox.width*uiScaleX/3,"left"),fillTextShrinkToFit(e,u.top,b.x*uiScaleX+s.boundingBox.width*uiScaleX/3,d,s.boundingBox.width*uiScaleX/3,"center")}}e.restore()}drawHitboxDebugForLayer(e,t,o=0){if(e.save(),t.isVisible()||t.isEnabled()){e.strokeStyle=hitboxDebugSettings.boxColors[o%hitboxDebugSettings.boxColors.length];var i=t.getGlobalCoordinates(0,0);if(e.strokeRect(i.x*uiScaleX,i.y*uiScaleY,t.boundingBox.width*uiScaleX,t.boundingBox.height*uiScaleY),e.stroke(),t.hitboxes)for(var n=0;n<t.hitboxes.length;++n){var a=t.hitboxes[n];(a.isVisible()||a.isEnabled())&&this.drawHitboxDebugForLayer(e,a,o+1)}e.restore()}}logMouseCoordinates(){var e=Array.from(Object.values(activeLayers));for(var t in console.log("LAYERS:"),e){var o=e[t];(i=o.getLocalCoordinates(mouseX,mouseY)).x=Math.round(i.x),i.y=Math.round(i.y),(l={}).x=(100*i.x/o.boundingBox.width).toFixed(2)+"%",l.y=(100*i.y/o.boundingBox.height).toFixed(2)+"%",console.log(e[t].layerName+": ("+i.x+"px, "+i.y+"px) | ("+l.x+", "+l.y+")")}if(candidateHitboxes.length>0)for(var t in console.log("HITBOXES:"),candidateHitboxes){var i,n=candidateHitboxes[t];if(n.id)var a=n.id;else a="No ID";(i=n.getLocalCoordinates(mouseX,mouseY)).x=i.x.toFixed(1),i.y=i.y.toFixed(1);var l=n.getLocalCoordinates(mouseX,mouseY);l.x=(100*l.x/n.boundingBox.width).toFixed(1)+"%",l.y=(100*l.y/n.boundingBox.height).toFixed(1)+"%",console.log(a+": ("+i.x+"px, "+i.y+"px) | ("+l.x+", "+l.y+")")}}}function showHitboxDebug(e=-1,t=null){activeLayers.HitboxDebug?(e>0||null!==t)&&(hitboxDebugSettings.labelMode=e,hitboxDebugSettings.onlyShowTopLayer=t):(activeLayers.HitboxDebug=new HitboxDebug({x:0,y:0,width:mainw,height:mainh},e,t),activeLayers.HitboxDebug.open())}function hideHitboxDebug(){activeLayers.HitboxDebug&&(activeLayers.HitboxDebug.close(),delete activeLayers.HitboxDebug)}window.addEventListener("resize",(function(){activeLayers.HitboxDebug&&(hideHitboxDebug(),showHitboxDebug())}));