const GLOBAL_DPI_SCALE=1;class WebPlatform extends Platform{pendingOrder;domain;paymentOverlayMaxLoadAttempts=8;constructor(){super(),this.language=this.getSystemLanguage(),""!=languageOverride&&translations.hasOwnProperty(languageOverride)&&(this.language=languageOverride);try{if(document.referrer.includes("armorgames"))this.domain="armorgames";else{var e=document.referrer.split("://")[1].split(".");e.length>=3?this.domain=e[1]:this.domain=e[0]}}catch(e){console.warn(e)}}initMusic(){return this.music=new Audio(mainMusic),this.music.volume=0,this.music.loop=!0,this.music}toggleMusic(){this.music||this.initMusic(),this.music.volume=0==mute?musicFadeInVolume:0}playMusic(){this.music||this.initMusic(),this.music.play()}initPurchases(e=1e3,t=0){if("undefined"!=typeof playsaurusPayments)playsaurusPayments.createPopup().then(function(){playsaurusPayments.initializePaypal("ATTJm7-432QyQzMBX0HXcCb1r-xY_gEdK0mFV5gab9WiHeWIIFQJ6SAqFqUV3iL5u9EbWbdGCfkqvoL7"),playsaurusPayments.initializeStripe("pk_live_51LXY6dCnj0k6kn1bSZh8iTuuwSCatikN7phnZliGCtUFNbYbt5fbd9kASEpkUrIRKJq3s3XpFP2FsJTw7pvxL8qm00gem4z1vJ"),playsaurusPayments.registerProducts(this.buildProducts()),playsaurusPayments.setPurchaseSuccessCallback(function(e){console.log("Purchased "+e.name),this.completePurchase(e.packNum)}.bind(this))}.bind(this));else if(t>=this.paymentOverlayMaxLoadAttempts)console.error("Failed to initialize payment overlay (playsaurusPayments is undefined)");else{e>=6e4&&(e=6e4),setTimeout(this.initPurchases.bind(this,2*e),e,t+1)}}buildProducts(){for(var e=[],t=[v5Tix10,v5Tix55,v5Tix120,v5Tix250,v5Tix650,v5Tix1400],s=0;s<purchasePacks.length;++s)0==Object.values(purchasePacks[s]).length?e.push({packNum:s,sku:"",name:"",image:"",price:0,description:""}):e.push({packNum:s,sku:purchasePacks[s].ag_sku,name:purchasePacks[s].description,image:t[s-1].src,price:purchasePacks[s].priceCents,description:""});return e}buyPack(e){"armorgames"==this.domain?window.parent.postMessage({type:"purchase",sku:purchasePacks[e].ag_sku},"https://19230.cache.armorgames.com"):playsaurusPayments&&playsaurusPayments.startPurchase(e)}completePurchase(e){console.log(e),alert("Transaction complete. Thank you for your purchase!");var t=purchasePacks[e].tickets;trackEvent_PurchasedTickets(t,purchasePacks[e].priceCents),tickets+=t,console.log("Added "+t+" tickets"),centsSpent+=purchasePacks[e].priceCents;var s="mrmine_"+t+"tickets";logRevenue(purchasePacks[e].priceCents,s);var a=purchasePacks[e].priceCents/100,i=(new amplitude.Revenue).setProductId("tickets_"+tickets).setPrice(a).setQuantity(1);amplitude.getInstance().logRevenueV2(i),ajax("backend/logtransaction.php",{paymentAmount:purchasePacks[e].priceCents/100,ticketsPurchased:t,uid:platform.getUserId()},"POST",(()=>handleNameSubmission())),fbq&&fbq("track","Purchase",{currency:"USD",value:purchasePacks[e].priceCents/100}),"undefined"!=typeof gtag&&null!=gtag&&gtag("event","purchase",{transaction_id:rand(0,1e10),value:a,currency:"USD",shipping:0,items:[{id:"tickets_"+tickets,name:"tickets_"+tickets,quantity:1,price:a}]}),platform.pendingOrder=null}setQuestData(){questManager.getQuest(20).name=_("JOIN THE COMMUNITY"),questManager.getQuest(20).description=_("Join the Mr.Mine discord for news, promo codes, and more!"),questManager.getQuest(20).additionalOnClick=function(){openDiscord(),checkReview()},window.a20=window.a20v2,window.a20g=window.a20gv2}getUserId(){return void 0===localStorage.uid&&(localStorage.uid=rand(100,Number.MAX_SAFE_INTEGER)),localStorage.uid}getSystemLanguage(){return getLanguageFromCode(window.navigator.userLanguage||window.navigator.language)}openSurvey(){if(depth>20&&!hasTakenSurveyCheck()&&!localStorage.isSurveyPending&&null==document.getElementById("surveyDiv")){var e=5*surveyRewardMultiplier(),t=document.createElement("div");t.id="surveyDiv",t.style.cssText="position:absolute;left:20%;top:10%;width:60%;height:80%;z-index:100;background:#000;border: 1px solid black;",t.innerHTML='<iframe src="./Shared/survey.html?UID='+UID+"&version="+version+"&depth="+depth+"&reward="+e+'" frameBorder="0" style="width: 100%; height: 100%; boder:0;"></iframe>';var s=document.createElement("div");s.id="surveyExitButton",s.style.position="absolute",s.style.top="0px",s.style.right="0px",s.style.width="25px",s.style.height="25px",s.style.zIndex=4,s.style.background="url('Shared/Assets/UI/closei.png') no-repeat center",s.style.backgroundSize="contain",s.style.color="white",s.style.display="block",s.style.padding="0px",s.style.cursor="pointer",s.onclick=function(){document.getElementById("surveyDiv").visibility="hidden",document.body.removeChild(document.getElementById("surveyDiv"))},t.appendChild(s),document.body.appendChild(t)}}openFlashSurvey(){if(isFlashQuestionSurveyPromptVisible()){var e=numFlashQuestions*surveyRewardMultiplier(),t=document.createElement("div");t.id="surveyDiv",t.style.cssText="position:absolute;left:20%;top:10%;width:60%;height:80%;z-index:100;background:#000;border: 1px solid black;",t.innerHTML='<iframe src="./Shared/ServerSurvey.html?UID='+UID+"&version="+version+"&depth="+depth+"&reward="+e+'" frameBorder="0" style="width: 100%; height: 100%; boder:0;"></iframe>';var s=document.createElement("div");s.id="surveyExitButton",s.style.position="absolute",s.style.top="0px",s.style.right="0px",s.style.width="25px",s.style.height="25px",s.style.zIndex=4,s.style.background="url('Shared/Assets/UI/closei.png') no-repeat center",s.style.backgroundSize="contain",s.style.color="white",s.style.display="block",s.style.padding="0px",s.style.cursor="pointer",s.onclick=function(){document.getElementById("surveyDiv").visibility="hidden",document.body.removeChild(document.getElementById("surveyDiv"))},t.appendChild(s),document.body.appendChild(t),lastFlashQuestionPromptClickTime=currentTime(),hasVisitedFlashQuestionSurveyDuringCurrentSession=!0}}}function getCurrentWindow(){return window}window.addEventListener("message",(function(e){if("https://files.armorgames.com"==e.origin||"https://19230.cache.armorgames.com"==e.origin)switch(e.data.type){case"purchase":var t=getPurchasePackIndexBySku(e.data.data.sku);platform.completePurchase(t);break;case"consumeOldPurchase":t=getPurchasePackIndexBySku(e.data.data.sku);platform.completePurchase(t);break;case"loginStatus":platform.isLoginRequired=!0,platform.isLoggedInToHost=e.data.value}}));var platform=new WebPlatform;language=platform.language;const SUBSCRIPTION_ENDPOINT="https://mrmine.com/subscribe.php",CODE_REDEMPTION_ENDPOINT="https://mrmine.com/redemption.php";var assetLoader=new AssetLoader;assetLoader.setEndpoint("https://cdn.mrmine.com/game/desktop/"),loadAssets(),window.addEventListener("load",(function(){"armorgames"!=platform.domain&&platform.initPurchases()}));