const TOUCH_MOVE_MAX_DIST=20;var hitboxMouseUpFunction,prevMouseX,prevMouseY,mouseX,mouseY,relativePrevMouseX,relativePrevMouseY,relativeMouseX,relativeMouseY,touchMoveDist=0,activeLayers={},currentTargetHitbox={},candidateHitboxes=[],enteredHitboxes=[],isMouseUpFunctionReal=!1,isMouseDown=!1,isDragging=!1,mouseDeltaBuffer=[],mouseDeltaBufferLength=10,mouseDeltaBufferIndex=0;function bindMouseHandlers(e){isMobile()&&"undefined"!=typeof cordova?(e.addEventListener("touchmove",mouseMoveHandler),e.addEventListener("touchstart",mouseDownHandler),e.addEventListener("touchend",mouseUpHandler)):(e.addEventListener("mousemove",mouseMoveHandler),e.addEventListener("mousedown",mouseDownHandler),e.addEventListener("mouseup",mouseUpHandler)),e.addEventListener("wheel",mouseWheelHandler,{passive:!1})}function mouseMoveHandler(e){if(mouseMoved=!0,!platform.treatClicksAsTouches||isMouseDown){if(prevMouseX=mouseX,prevMouseY=mouseY,e.touches?(mouseX=e.touches[0].clientX,mouseY=e.touches[0].clientY):(mouseX=e.clientX,mouseY=e.clientY),writeToMouseDeltaBuffer(prevMouseX-mouseX,prevMouseY-mouseY),isMobile()&&isDragging&&currentTargetHitbox){var o=currentTargetHitbox.hitbox;if(o.onmousemove)o.onmousemove(e);else for(;o.parent;){if(o.parent.onmousemove){o.parent.onmousemove(e);break}o=o.parent}}else updateCurrentTargetHitbox(e);(platform.treatClicksAsTouches||e.touches)&&(touchMoveDist+=Math.sqrt(Math.pow(mouseX-prevMouseX,2)+Math.pow(mouseY-prevMouseY,2)),!isMouseUpFunctionReal&&touchMoveDist>20&&(hitboxMouseUpFunction=null),!activeLayers.WorldLayer||currentTargetHitbox&&("WorldLayer"!=currentTargetHitbox.hitbox.getRootLayer().layerName||currentTargetHitbox.hitbox.onmousemove)||activeLayers.WorldLayer.onmousemove()),isDragging=!0}}function writeToMouseDeltaBuffer(e,o){mouseDeltaBuffer[mouseDeltaBufferIndex]={x:e,y:o},(++mouseDeltaBufferIndex>=mouseDeltaBufferLength||mouseDeltaBufferIndex<0)&&(mouseDeltaBufferIndex=0)}function mouseDownHandler(e){if(!e.target.classList.contains("languageSelection")){isMouseDown=!0,e.touches?(prevMouseX=mouseX,prevMouseY=mouseY,mouseX=e.touches[0].clientX,mouseY=e.touches[0].clientY,mouseMoveHandler(e)):platform.treatClicksAsTouches&&(prevMouseX=mouseX,prevMouseY=mouseY,mouseX=e.clientX,mouseY=e.clientY,mouseMoveHandler(e)),hitboxMouseUpFunction&&(console.log("mouseup1"),hitboxMouseUpFunction(e),hitboxMouseUpFunction=null);var o=getTargetHitboxWithProperty("onmousedown");o&&(o.onmouseup||!e.touches&&!platform.treatClicksAsTouches?(o.onmousedown(e),o.onmouseup&&(hitboxMouseUpFunction=o.onmouseup,isMouseUpFunctionReal=!0)):(hitboxMouseUpFunction=o.onmousedown.bind(o),isMouseUpFunctionReal=!1)),updateCurrentTargetHitbox()}}function mouseUpHandler(e){isMouseDown=!1,isDragging=!1,touchMoveDist=0,hitboxMouseUpFunction?(hitboxMouseUpFunction(e),hitboxMouseUpFunction=null):!platform.treatClicksAsTouches&&!e.touches||!activeLayers.WorldLayer||currentTargetHitbox&&("WorldLayer"!=currentTargetHitbox.hitbox.getRootLayer().layerName||currentTargetHitbox.hitbox.onmousemove)||activeLayers.WorldLayer.onmouseup(),mouseDeltaBuffer=[],mouseDeltaBufferIndex=0}function mouseWheelHandler(e){e.preventDefault();var o=getTargetHitboxWithProperty("onwheel",!0);if(o)return o.onwheel(e),void updateCurrentTargetHitbox();wheel(e)}function mouseEnterExitHandler(e){var o=getTopHitboxesWithProperty("onmouseenter"),t=o.filter((e=>!enteredHitboxes.includes(e))),n=enteredHitboxes.filter((e=>!o.includes(e)));for(var u in n)n[u].onmouseexit&&n[u].onmouseexit(e);for(var u in t)t[u].onmouseenter(e);enteredHitboxes=o}function isMouseWithinBounds(e,o=null){var t=0,n=0;return o&&(t=o.x,n=o.y),mouseX/uiScaleX>=e.x+t&&mouseX/uiScaleX<=e.x+e.width+t&&mouseY/uiScaleY>=e.y+n&&mouseY/uiScaleY<=e.y+e.height+n}function updateCurrentTargetHitbox(e){var o=Object.keys(activeLayers);candidateHitboxes=[];for(var t=0;t<o.length;++t){var n=activeLayers[o[t]];if(n.name&&"MainUILayer"==n.name||"WorldLayer"==n.name||isMouseWithinBounds(n.boundingBox)){if(!n.isEnabled()&&isMouseWithinBounds(n.boundingBox)){document.body.style.cursor&&(document.body.style.cursor=""),candidateHitboxes=[];continue}relativePrevMouseX=prevMouseX-n.boundingBox.x,relativePrevMouseY=prevMouseY-n.boundingBox.y,relativeMouseX=mouseX-n.boundingBox.x,relativeMouseY=mouseY-n.boundingBox.y;var u=n.findMatchingHitboxes();candidateHitboxes=candidateHitboxes.concat(u)}}if(candidateHitboxes.length>0){var s=candidateHitboxes[candidateHitboxes.length-1];currentTargetHitbox&&s===currentTargetHitbox.hitbox||(currentTargetHitbox={layer:n,layerName:o[t],hitbox:s}),s.onmousemove&&s.onmousemove(e);var r=getTargetHitboxWithProperty("onmousedown")||getTargetHitboxWithProperty("cursor");if(r){var i=r.cursor||"pointer";document.body.style.cursor!=i&&(document.body.style.cursor=i)}else document.body.style.cursor=""}else document.body.style.cursor&&(document.body.style.cursor=""),currentTargetHitbox=null;mouseEnterExitHandler()}function getTargetHitboxWithProperty(e,o=!1){for(var t=candidateHitboxes.length-1;t>=0;--t){if(candidateHitboxes[t][e])return candidateHitboxes[t];if(!o&&!candidateHitboxes[t].allowBubbling)return null}return null}function getTopHitboxesWithProperty(e,o){for(var t=[],n=candidateHitboxes.length-1;n>=0;--n)if(candidateHitboxes[n][e]&&t.push(candidateHitboxes[n]),!o&&!candidateHitboxes[n].allowBubbling)return t;return t}function dragDistance(){return Math.sqrt(Math.pow(prevMouseX-mouseX,2)+Math.pow(prevMouseY-mouseY,2))}function mobilePcEventOverride(){buildTarget=STEAM_BUILD,bindMouseHandlers(window)}function disableMouseEvents(e,o=0){if(e.style&&"none"!=e.style.pointerEvents){var t=e.style.pointerEvents;e.style.pointerEvents="none",o>0&&setTimeout((()=>{e.style.pointerEvents=t}),o)}}function disableOnClickHtmlEvent(e,o=0){if(e.onclick){var t=e.onclick;e.onclick=null,o>0&&setTimeout((()=>{e.onclick=t}),o)}}bindMouseHandlers(window),document.getElementById("SIMPLEINPUTFIELD").onmousedown=function(e){e.stopPropagation()},document.getElementById("SIMPLEINPUTFIELD").onmousemove=function(e){prevMouseX=mouseX,prevMouseY=mouseY,mouseX=e.clientX,mouseY=e.clientY,document.body.style.cursor&&(document.body.style.cursor=""),e.stopPropagation()},document.getElementById("LANGUAGESELECTIOND").onmousedown=function(e){e.stopPropagation()},document.getElementById("LANGUAGESELECTIOND").onmousemove=function(e){prevMouseX=mouseX,prevMouseY=mouseY,mouseX=e.clientX,mouseY=e.clientY,document.body.style.cursor&&(document.body.style.cursor=""),e.stopPropagation()};