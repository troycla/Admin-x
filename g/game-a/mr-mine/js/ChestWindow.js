class ChestWindow extends TabbedPopupWindow{layerName="Chest";domElementId="CHESTD";context=CH;chestIsOpen=!1;animationStartFrame=-1;animationLength=8;zIndex=10;constructor(t,e){super(t),t||this.setBoundingBox(),this.initializeTabs(Object.values({})),this.chest=e,e.type==ChestType.gold?this.spritesheet=goldChestSpritesheet:e.type==ChestType.black?this.spritesheet=blackChestSpritesheet:this.spritesheet=basicChestSpritesheet,this.chestIconWidth=.4*this.boundingBox.width,this.chestIconHeight=.4*this.boundingBox.height,this.addHitbox(new Hitbox({x:0,y:0,width:.95*this.boundingBox.width,height:.95*this.boundingBox.height},{onmousedown:function(){this.parent.onChestClicked()}},"pointer","chestButton")),this.render()}onChestClicked(){this.chestIsOpen?closeUi(this):(this.animationStartFrame=numFramesRendered,this.chestIsOpen=!0,chestService.giveChestReward(this.chest),newNews(_("You got {0} from a Chest!",chestService.getChestRewardText()),!0),this.chest.type==ChestType.gold?mutebuttons||chestGoldOpenAudio.play():mutebuttons||chestOpenAudio.play())}render(){this.context.save(),this.context.clearRect(0,0,this.boundingBox.width,this.boundingBox.height),this.context.restore(),super.render(),this.chestIsOpen?this.renderOpenChest():this.renderClosedChest()}close(){return 0!=worlds[0].workersHired||this.chestIsOpen||this.onChestClicked(),super.close()}renderChest(){var t=this.getAnimationFrame(),e=this.spritesheet.width/this.animationLength;this.context.drawImage(this.spritesheet,t*e,0,e,this.spritesheet.height,this.boundingBox.width/2-this.chestIconWidth/2,this.boundingBox.height/2-this.chestIconHeight/2,this.chestIconWidth,this.chestIconHeight)}renderOpenChest(){this.renderChest(),this.context.fillStyle="#FFFFFF",this.context.strokeStyle="#000000",this.context.lineWidth=2,this.context.strokeText(_("You got {0}!",chestService.getChestRewardText()),.5*this.boundingBox.width-.5*this.context.measureText(_("You got {0}!",chestService.getChestRewardText())).width,200),this.context.fillText(_("You got {0}!",chestService.getChestRewardText()),.5*this.boundingBox.width-.5*this.context.measureText(_("You got {0}!",chestService.getChestRewardText())).width,200),this.context.fillStyle="#FFFFFF",this.context.fillText(_("CLICK CHEST TO CLOSE"),.5*this.boundingBox.width-.5*this.context.measureText(_("CLICK CHEST TO CLOSE")).width,.8*chestch)}renderClosedChest(){this.renderChest(),this.context.fillStyle="#FFFFFF",this.context.fillText(_("CLICK CHEST TO OPEN"),.5*this.boundingBox.width-.5*this.context.measureText(_("CLICK CHEST TO OPEN")).width,.8*chestch)}getAnimationFrame(){return this.animationStartFrame<0?0:numFramesRendered-this.animationStartFrame>=this.animationLength?this.animationLength-1:(numFramesRendered-this.animationStartFrame)%this.animationLength}}