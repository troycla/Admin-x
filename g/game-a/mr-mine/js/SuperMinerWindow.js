class SuperMinerWindow extends PopupWindow{layerName="SuperMinerWindow";domElementId="SMSD";context=SMS;isRendered=!0;isPopup=!0;allowBubbling=!0;constructor(t,i){super(t),this.superMiner=i,this.bg=i.rarity.largeFrame,this.showingTooltip=!1,this.buttonAnimation=new SpritesheetAnimation(btnShine,7,7),this.lastAnimation=0,this.setBoundingBox();this.boundingBox.x,this.boundingBox.y;var n=this.boundingBox.width,o=this.boundingBox.height;this.boundingBox.height=.75*o,this.boundingBox.y=(o-this.boundingBox.height)/2,this.boundingBox.width=i.rarity.largeFrame.width*this.boundingBox.height/i.rarity.largeFrame.height,this.boundingBox.x=(n-this.boundingBox.width)/2,this.initHitboxes()}initHitboxes(){this.closeButton=this.addHitbox(new Hitbox({x:.9*this.boundingBox.width,y:0,width:.1*this.boundingBox.width,height:.065*this.boundingBox.height},{onmousedown:function(){openUi(SuperMinersWindow),hideTooltip()}},"pointer","closeButton",!0,!0)),this.levelUpButton=this.addHitbox(new Hitbox({x:.05*this.boundingBox.width,y:.573*this.boundingBox.height,width:.9*this.boundingBox.width,height:.075*this.boundingBox.height},{onmousedown:()=>{this.superMiner.canLevel()&&showConfirmationPrompt(_("Level up {0} for {1} Super Miner Souls",this.superMiner.name,this.superMiner.getLevelCost()),_("Yes"),(()=>{this.superMiner.canLevel()&&this.superMiner.levelUp()}),_("No"))}},"pointer","levelUpButton",!0,!0)),this.skillButton=this.addHitbox(new Hitbox({x:.05*this.boundingBox.width,y:.74*this.boundingBox.height,width:.195*this.boundingBox.width,height:.13*this.boundingBox.height},{onmousedown:()=>{isMobile()&&this.superMiner.percentageUntilAction()<1&&(!this.showingTooltip&&this.superMiner.buttonTooltip?(showUpdatingTooltip((()=>this.superMiner.buttonTooltip()),.345*this.boundingBox.width,.56*this.boundingBox.height,.1*mainw),this.showingTooltip=!0):(this.showingTooltip=!1,hideTooltip())),this.superMiner.onButtonPress&&this.superMiner.onButtonPress()},onmouseenter:()=>{this.superMiner.percentageUntilAction()<1&&this.superMiner.buttonTooltip&&showUpdatingTooltip((()=>this.superMiner.buttonTooltip()),.345*this.boundingBox.width,.56*this.boundingBox.height,.1*mainw)},onmouseexit:()=>hideTooltip()},"pointer","skillButton",!0,!0))}render(){this.context.save(),this.context.clearRect(0,0,this.boundingBox.width,this.boundingBox.height),this.context.font=.05*this.boundingBox.height+"px KanitB",this.context.lineWidth=6;let t=this.superMiner.hasButton?this.superMiner.rarity.button:this.superMiner.rarity.flatButton,i=this.superMiner.buttonIcon,n=this.superMiner.rarity.name,o=this.superMiner.portrait,e=this.boundingBox.width,h=this.boundingBox.height,s=this.boundingBox.x,r=this.boundingBox.y,d=s,u=r;this.context.drawImage(this.bg,s,r,e,h),this.context.lineWidth=6,this.context.fillStyle="#FFFFFF",strokeTextShrinkToFit(this.context,this.superMiner.name,d+.05*this.boundingBox.width,r+.055*h,.6*e,"left"),this.context.strokeStyle="#000000",fillTextShrinkToFit(this.context,this.superMiner.name,d+.05*this.boundingBox.width,r+.055*h,.6*e,"left"),this.context.fillStyle="#000000",fillTextShrinkToFit(this.context,_("Lvl. {0}",this.superMiner.level),d,r+.055*h,.83*e,"right"),drawImageFitInBox(this.context,o,d+.2*e,u+.101*h,.585*e,.403*h,"center","bottom"),this.context.font=.025*this.boundingBox.height+"px KanitB",this.context.strokeStyle="#FFFFFF",this.context.lineWidth=2,strokeTextShrinkToFit(this.context,n,s,r+.535*h,e,"center"),this.context.fillStyle="#A25D03",fillTextShrinkToFit(this.context,n,s,r+.535*h,e,"center"),this.context.strokeStyle="#000000";let x=this.superMiner.canLevel()?smGreenButton:smGrayButton;this.context.fillStyle=this.superMiner.canLevel()?"#000000":"#c52c2e",this.context.font=.03*this.boundingBox.height+"px KanitB";let g=this.getHitboxById("levelUpButton");if(this.context.drawImage(x,d+g.boundingBox.x,u+g.boundingBox.y,g.boundingBox.width,g.boundingBox.height),this.superMiner.isMaxLevel())fillTextShrinkToFit(this.context,_("MAX LEVEL"),d+g.boundingBox.x,u+g.boundingBox.y+.7*g.boundingBox.height,g.boundingBox.width,"center");else{let t=fillTextShrinkToFit(this.context,_("Level up: {0}",this.superMiner.getLevelCost()),d+g.boundingBox.x,u+g.boundingBox.y+.7*g.boundingBox.height,.9*g.boundingBox.width,"center"),i=worldResources[SUPER_MINER_SOULS_INDEX],n=.5*g.boundingBox.height;this.context.drawImage(i.largeIcon,0,0,i.largeIcon.width,i.largeIcon.height,t.x2+5,u+g.boundingBox.y+.25*g.boundingBox.height,n,n)}let l=this.getHitboxById("skillButton");if(this.context.drawImage(t,0,0,t.width,t.height,d+l.boundingBox.x,u+l.boundingBox.y,l.boundingBox.width,l.boundingBox.height),i&&this.context.drawImage(i,0,0,i.width,i.height,d+l.boundingBox.x+.05*l.boundingBox.width,u+l.boundingBox.y+.05*l.boundingBox.height,.9*l.boundingBox.width,.9*l.boundingBox.height),this.superMiner.canPressButton()&&(currentTime()-4e3>this.lastAnimation&&(this.lastAnimation=currentTime(),this.buttonAnimation.gotoAndPlay(0),this.buttonAnimation.playUntilFinished()),this.buttonAnimation.isPaused||this.buttonAnimation.drawAnimation(this.context,d+l.boundingBox.x,u+l.boundingBox.y,l.boundingBox.width,l.boundingBox.height)),this.superMiner.needsProgressBar){this.context.fillStyle="#000000",renderRoundedRectangle(this.context,d+.31*l.boundingBox.width,u+l.boundingBox.y+1.05*l.boundingBox.height,.9*l.boundingBox.width,.03*h,2,"#000000","#000000",2),this.context.fillStyle="#FF8800";let t=Math.max(.06,this.superMiner.percentageUntilAction());renderRoundedRectangle(this.context,d+.31*l.boundingBox.width,u+l.boundingBox.y+1.05*l.boundingBox.height,.88*l.boundingBox.width*t,.03*h,4,"#000000","#FF8800",0)}this.context.fillStyle="#FFFFFF",this.context.font=.03*this.boundingBox.height+"px Verdana",this.context.textBaseline="top",this.superMiner.renderDescription&&this.superMiner.renderDescription(this.context,d+.33*this.boundingBox.width,u+.7*this.boundingBox.height,.6*this.boundingBox.width,.25*this.boundingBox.height),this.context.restore(),super.render()}}