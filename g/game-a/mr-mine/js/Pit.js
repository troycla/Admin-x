var mineralsSacrificed=0,isCoreWarped=0,isCoreBlessed=0;const BOOK_OF_SECRETS_ID=45,WARPED_BOOK_OF_SECRETS_ID=80,DIVINE_BOOK_OF_SECRETS_ID=113;class Pit{makeSacrifice(e,i,s){switch(e){case PitConfig.sacrificeTypes.ore:if(worldResources[i].numOwned<s)return!1;break;case PitConfig.sacrificeTypes.relic:if(-1==equippedRelics[i])return!1;break;case PitConfig.sacrificeTypes.scientist:if(i>aliveScientists().length)return!1;break;default:throw"Error: Invalid sacrifice type"}var r=this.getSacrificeValue(e,i,s),c=this.getSacrificeReward(e,i,r);switch(this.showSacrificeNews(e,i,s,c),e){case PitConfig.sacrificeTypes.ore:worldResources[i].numOwned-=s;break;case PitConfig.sacrificeTypes.relic:deleteEquippedRelic(i);break;case PitConfig.sacrificeTypes.scientist:c?deleteScientistAtIndex(indexOfScientist(aliveScientists()[i])):killScientistAtIndex(indexOfScientist(aliveScientists()[i])),numScientistsSacrificed++;break;default:throw"Error: Invalid sacrifice type"}c&&this.grantSacrificeReward(c),mineralsSacrificed+=s}getSacrificeValue(e,i,s){switch(e){case PitConfig.sacrificeTypes.ore:return parseInt(worldResources[i].sellValue)*s;case PitConfig.sacrificeTypes.gem:return s*PitConfig.sacrificeValueModifiers.gem;case PitConfig.sacrificeTypes.relic:return PitConfig.sacrificeValueModifiers.relic;case PitConfig.sacrificeTypes.scientist:return PitConfig.sacrificeValueModifiers.scientist;default:throw"Error: Invalid sacrifice type"}}getSacrificeReward(e,i,s){var r,c,a,t=e==PitConfig.sacrificeTypes.relic&&(45==equippedRelics[i]||80==equippedRelics[i]||113==equippedRelics[i]);if(e==PitConfig.sacrificeTypes.ore&&coreMineralRoller.randFloat()>PitConfig.rewardConfig.sacrificeSuccessChance)return null;if(e==PitConfig.sacrificeTypes.relic&&!isCoreWarped&&!isCoreBlessed&&coreRelicRoller.randFloat()>PitConfig.rewardConfig.sacrificeSuccessChance&&!t)return null;if(e==PitConfig.sacrificeTypes.scientist&&!isCoreWarped&&!isCoreBlessed&&coreScientistRoller.randFloat()>PitConfig.rewardConfig.sacrificeSuccessChance)return null;var n=0;if(e==PitConfig.sacrificeTypes.ore){var o=this.getPossibleOreRewardsArray(e);r=PitConfig.sacrificeTypes.ore,c=gaussianRand(PitConfig.rewardConfig.medianValue,PitConfig.rewardConfig.valueSpread),a=o[coreMineralRoller.rand(0,o.length-1)],n=randRoundToInteger(c*s/parseInt(worldResources[a].sellValue))}if(e==PitConfig.sacrificeTypes.relic){var f=excavationRewards[equippedRelics[i]];if(45==f.id&&!isCoreWarped)return{type:PitConfig.sacrificeTypes.special,subtype:1,quantity:1};if((80==f.id||113==f.id)&&!isCoreBlessed)return{type:PitConfig.sacrificeTypes.special,subtype:2,quantity:1};if(f.relatedIndexesForSacrifice.length>0)if(isCoreWarped)r=PitConfig.sacrificeTypes.relic,a=f.warpId,n=1,isCoreWarped=!1,isCoreBlessed=!1;else if(isCoreBlessed)r=PitConfig.sacrificeTypes.relic,a=f.divineId,n=1,isCoreWarped=!1,isCoreBlessed=!1;else{var l=f.relatedIndexesForSacrifice[coreRelicRoller.rand(0,f.relatedIndexesForSacrifice.length-1)],d=excavationRewards[l],p=-.29+Math.pow(coreRelicRoller.randFloat(),3);d.rarity<f.rarity+p&&(r=PitConfig.sacrificeTypes.relic,a=l,n=1)}}if(e==PitConfig.sacrificeTypes.scientist){var u=scientists[aliveScientists()[i][0]];isCoreWarped||isCoreBlessed?coreScientistRoller.boolean(.5)&&(r=PitConfig.sacrificeTypes.scientist,a=u.warpedId,n=1,isCoreWarped=!1,isCoreBlessed=!1):coreScientistRoller.boolean(.5)&&(r=PitConfig.sacrificeTypes.scientist,a=getRandomScientistId(),n=1)}return n<=0?null:{type:r,subtype:a,quantity:n}}grantSacrificeReward(e){switch(e.type){case PitConfig.sacrificeTypes.ore:worldResources[e.subtype].numOwned+=e.quantity;break;case PitConfig.sacrificeTypes.relic:equipRelic(e.subtype);break;case PitConfig.sacrificeTypes.special:1==e.subtype?(isCoreWarped=!0,isCoreBlessed=!1):2==e.subtype&&(isCoreWarped=!1,isCoreBlessed=!0);break;case PitConfig.sacrificeTypes.scientist:unlockScientistOfId(e.subtype);break;default:throw"Error: Invalid sacrifice type"}}getPossibleOreRewardsArray(e){return[1,2,3,4,5,6,7,8,9,10,11,12,1,2,3,4,5,6,7,8,9,10,11,12,1,2,3,4,5,6,7,8,9,10,11,12,1,2,3,4,5,6,7,8,9,10,11,12,1,2,3,4,5,6,7,8,9,10,11,12,1,2,3,4,5,6,7,8,9,10,11,12]}showSacrificeNews(e,i,s,r){var c,a;switch(e){case PitConfig.sacrificeTypes.ore:c=beautifynum(s)+" "+worldResources[i].name;break;case PitConfig.sacrificeTypes.relic:c=excavationRewards[equippedRelics[i]].name;break;case PitConfig.sacrificeTypes.scientist:c=scientists[aliveScientists()[i][0]].name;break;default:throw"Error: Invalid sacrifice type"}if(r){switch(r.type){case PitConfig.sacrificeTypes.ore:a=beautifynum(r.quantity)+" "+worldResources[r.subtype].name;break;case PitConfig.sacrificeTypes.relic:a=excavationRewards[r.subtype].name;break;case PitConfig.sacrificeTypes.special:if(1==r.subtype)return newNews(_("You sacrificed Book of Secrets")),newNews(_("Corruption spreads through the core")),void(mutebuttons||sacrificeWarped.play());if(2==r.subtype)return newNews(_("You sacrificed Book of Secrets+")),newNews(_("The core emits a golden hue")),void(mutebuttons||sacrificeDivine.play());break;case PitConfig.sacrificeTypes.scientist:a=scientists[r.subtype].name;break;default:throw"Error: Invalid reward type"}newNews(_("You sacrificed {0} and received {1}!",c,a),!0),mutebuttons||sacrificeMineralAudio.play()}else newNews(_("You sacrificed {0}... but nothing happened.",c),!0),mutebuttons||sacrificeMineralAudio.play()}}var pit=new Pit;