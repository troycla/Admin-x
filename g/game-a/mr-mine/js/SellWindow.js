class SellWindow extends TabbedPopupWindow{layerName="SELL";domElementId="SELLD";context=SL;worldIndex;resourcePane;constructor(t,e,i=0){super(t),t||this.setBoundingBox(),this.setFrameImagesByWorldIndex(e),this.currentTabIndex=i,this.worldIndex=e;var o={0:_("Sell Ore"),1:_("Sell Isotope")};this.initializeTabs(Object.values(o));for(var n=0;n<13;n++){var s=.0575*this.boundingBox.height*(n+2.5);if(this.addHitbox(new Hitbox({x:.045*this.boundingBox.width,y:s,width:.2*this.boundingBox.width,height:.05*this.boundingBox.height},{onmousedown:this.sellButtonClick(n)},"pointer","sellButton_"+n)),n<12){var l=this.addHitbox(new Hitbox({x:.25*this.boundingBox.width,y:s,width:.04*this.boundingBox.width,height:.05*this.boundingBox.height},{onmousedown:this.lockButtonClick(n),onmouseenter:this.lockButtonHover(n),onmouseexit:function(){hideTooltip()}},"pointer","lockButton_"+n));l.isEnabled=function(t){return t<this.getTabResources().length}.bind(this,n),l.isVisible=l.isEnabled}}this.toggleSellButtons()}onTabChange(){this.toggleSellButtons()}toggleSellButtons(){for(var t=this.getTabResources(),e=0;e<12;++e)this.getHitboxById("sellButton_"+e).setEnabled(e<t.length)}getWorld(){return worlds[this.worldIndex]}getTabResources(){return 0==this.currentTabIndex?this.getWorld().mineralIdsToSell:1==this.currentTabIndex?this.getWorld().isotopeIdsToSell:void 0}render(){this.context.save(),this.context.clearRect(0,0,this.boundingBox.width,this.boundingBox.height),this.context.restore(),super.render(),this.context.fillStyle="#FFFFFF";this.context.font="14px Verdana";var t=STAT.sellPriceMultiplier(),e=.04*this.boundingBox.width,i=this.getTabResources(),o=0,n=new BigNumber(0);for(var s in i){var l=i[s],h=worldResources[l];o++;var r=.0575*this.boundingBox.height*(o+1.5);!h.isIsotope&&highestOreUnlocked>=l||h.isIsotope&&highestIsotopeUnlocked+2>=l?(this.context.fillText(h.name+": "+beautifynum(h.numOwned)+" = $"+beautifynum(doBigNumberDecimalMultiplication(h.totalValue(),t)),e+25+.25*this.boundingBox.width,4+r+.025*this.boundingBox.height),this.context.drawImage(h.smallIcon,0,0,h.smallIcon.width,h.smallIcon.height,e+3+.25*this.boundingBox.width,-12+r+.025*this.boundingBox.height,20,20)):(this.context.fillText(_("????")+": 0 = $0",e+25+.25*this.boundingBox.width,6+r+.025*this.boundingBox.height),this.context.drawImage(h.smallIconHidden,0,0,h.smallIconHidden.width,h.smallIconHidden.height,e+3+.25*this.boundingBox.width,-12+r+.025*this.boundingBox.height,20,20)),this.context.drawImage(getLockIconForMineralNumber(l),0,0,27,21,.25*this.boundingBox.width,r,.04*this.boundingBox.width,.05*this.boundingBox.height),renderButton(this.context,sellb,_("SELL"),.045*this.boundingBox.width,r,.2*this.boundingBox.width,.05*this.boundingBox.height,"14px Verdana","#000000"),n=n.add(getMineralSaleStats(l).profit)}r=.0575*this.boundingBox.height*14.25;renderButtonScaled(this.context,sellb,_("SELL ALL"),.045*this.boundingBox.width,r+.027*this.boundingBox.height,.2*this.boundingBox.width,.05*this.boundingBox.height,"14px Verdana","#000000"),this.context.fillText("$"+beautifynum(n),.25*this.boundingBox.width,r+.061*this.boundingBox.height),showSellerDialogue(),money.equals(0)&&getValueOfMineralsExcludingHe3()>=getEarth().workerHireCost()&&0==getEarth().workersHired&&drawImageRot(this.context,arrowleft,0,0,arrowleft.width,arrowleft.height,oscillate(numFramesRendered,8)*this.boundingBox.width*.018,.125*this.boundingBox.height,Math.floor(.075*this.boundingBox.width),Math.floor(.075*this.boundingBox.height),180)}close(){return activeLayers.MainUILayer.removeDialogueAttachment(),animate(),super.close()}sellButtonClick(t){return function(){for(var e=this.parent.getTabResources(),i=[],o=new BigNumber(money),n=0;n<e.length;n++)i[n]=worldResources[e[n]].numOwned;if(t<e.length)sellMineral(e[t]);else if(12==t)for(var n in e){var s=e[n];sellMineral(s)}0==mutebuttons&&(12!=t&&worldResources[e[t]].numOwned!=i[t]?mutebuttons||clickAudio[rand(0,clickAudio.length-1)].play():money.equals(o)||mutebuttons||clickAudio[rand(0,clickAudio.length-1)].play()),money.subtract(o).greaterThan(1e17)&&questManager.getQuest(55).markComplete()}}lockButtonClick(t){return function(){if(managerStructure.level>=1){var e=this.parent.getTabResources()[t];showSimpleInput(_("Enter the amount of {0} you want to prevent from being sold.",getLockedMineralName(e)),_("Update"),"0",getMineralUpdateLockFunction(e),_("Cancel"))}else{var i=openUi(CraftingWindow,null,0);i&&(i.openTab(1),i.selectedBlueprint=getBlueprintById(3,2),i.initializeCraftingPane())}mutebuttons||clickAudio[rand(0,clickAudio.length-1)].play()}}lockButtonHover(t){return function(){if(managerStructure.level>=1){var e=this.parent.getTabResources()[t];0==lockedMineralAmtsToSave[e]?showTooltip(_("Lock Resource"),_("Set minimum amount of {0} to keep",getLockedMineralName(e))):showTooltip(_("Resources Locked"),_("Locked to maintain a minimum of {0} {1}",beautifynum(lockedMineralAmtsToSave[e]),getLockedMineralName(e)))}else showTooltip(_("Craft a Manager to lock mineral amounts"),_("Click to go to the Craft Center"))}}}