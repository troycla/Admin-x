class PlaysaurusPayments{ready=!1;token;iframeHost="https://payments.playsaurus.com";iframePath="/v1/";iframeFile="popup/index.html";iframeSrc;paypalToken;stripeToken;products;popup;targetOrigin;successCallback;failureCallback;constructor(){this.iframeSrc=this.iframeHost+this.iframePath+this.iframeFile,window.addEventListener("message",this.receiveMessage.bind(this)),this.targetOrigin=this.iframeHost,this.app=document.currentScript.getAttribute("data-app")}createPopup(){var e=document.createElement("iframe"),a=document.createElement("link");e.src=this.iframeSrc+"?r="+window.location.origin+"&app="+this.app,e.id="playsaurusPaymentsFrame",e.allow="payment",e.classList.add("playsaurus-payments-frame"),e.classList.add("playsaurus-payments-frame--hidden"),this.popup=e,a.rel="stylesheet",a.href=this.iframeHost+this.iframePath+"popup/style/iframe.css",document.body.appendChild(a);const t=new Promise(((a,t)=>{e.addEventListener("load",(function(){playsaurusPayments.ready=!0,a()}))})),s=new Promise(((t,s)=>{a.addEventListener("load",(function(){document.body.appendChild(e),t()}))}));return Promise.all([t,s])}initializePaypalSandbox(){alert("Warning: Using Paypal sandbox"),this.initializePaypal("sb")}initializePaypal(e){this.paypalToken=e,this.sendMessage({mode:"initializePaypal",token:e})}initializeStripeSandbox(){this.initializeStripe("pk_test_TYooMQauvdEDq54NiTphI7jx")}initializeStripe(e){this.stripeToken=e,this.sendMessage({mode:"initializeStripe",token:e})}registerProducts(e){for(var a of e){if(void 0===a.price||void 0===a.name||void 0===a.image)throw"Error: Attempting to register invalid product";Object.freeze(a),Object.seal(a)}Object.defineProperty(this,"products",{value:e,writable:!1,enumerable:!0,configurable:!1}),Object.freeze(this.products)}setPurchaseSuccessCallback(e){this.successCallback=e}setPurchaseFailureCallback(e){this.failureCallback=e}startPurchase(e,a="",t={}){if(!this.ready)throw"Error: Payment popup isn't loaded!";this.token=a;var s={};Object.assign(s,this.products[e]),t.name&&(s.name=t.name),t.image&&(s.image=t.image),this.popup.classList.remove("playsaurus-payments-frame--hidden"),this.popup.contentWindow.postMessage({mode:"setProduct",product:s,token:a},this.targetOrigin)}hidePopup(){this.popup.classList.add("playsaurus-payments-frame--hidden"),this.token=null}onPurchaseSuccess(e,a){a==this.token?this.successCallback(e,a):this.failureCallback(e),this.hidePopup()}sendMessage(e){if(!this.ready)throw"Error: Payment popup isn't loaded!";this.popup.contentWindow.postMessage(e,this.targetOrigin)}receiveMessage(e){if(e.origin==this.targetOrigin)switch(console.log("FROM IFRAME: "),console.log(e),e.data.mode){case"purchaseComplete":this.onPurchaseSuccess(e.data.product,e.data.token);break;case"close":this.hidePopup()}}getQueryVariable(e){for(var a=window.location.search.substring(1).split("&"),t=0;t<a.length;t++){var s=a[t].split("=");if(decodeURIComponent(s[0])==e)return decodeURIComponent(s[1])}console.log("Query variable %s not found",e)}}const playsaurusPayments=new PlaysaurusPayments;